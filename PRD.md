# 录制回放工具 PRD

## 1. 背景与目标
提供一个 Windows 托盘应用，用于录制键盘/鼠标操作并按设定回放，支持全局快捷键触发，满足重复操作的自动化需求。

## 2. 目标用户与场景
- 目标用户：需要重复操作的办公/测试用户。
- 典型场景：表单重复填写、功能回归手工操作、演示脚本回放。

## 3. 需求范围
### 必做
- 全局快捷键触发录制与回放，且可在设置中修改。
- 回放支持设置次数与每次间隔（ms）。
- 录制内容包含鼠标移动/点击/滚轮。
- 录制数据与设置存储在本地用户目录（`%LOCALAPPDATA%\RecPlay`）。
- 托盘常驻，提供开始/停止录制、回放、设置、退出。

### 可选（后续）
- 键盘操作录制与回放（按下/抬起事件）。
- 多录制文件管理与命名。
- 回放暂停/继续。
- 回放进度提示与剩余次数显示。

## 4. 交互与流程
1) 用户通过热键或托盘菜单开始录制。  
2) 再次触发录制热键或菜单停止录制并保存。  
3) 触发回放热键开始回放；按同一热键停止回放。  
4) 设置窗口可调整热键、回放次数与间隔。

## 5. 设置项
- 录制热键（默认 `Ctrl+Alt+R`）
- 回放热键（默认 `Ctrl+Alt+P`）
- 回放次数（默认 1）
- 回放间隔（默认 1000ms）

## 6. 数据与存储
- 设置：`%LOCALAPPDATA%\RecPlay\settings.json`
- 录制：`%LOCALAPPDATA%\RecPlay\recording.json`
- 仅存本机，不上传网络。

## 7. 非功能需求
- 稳定性：连续回放不崩溃，异常需可恢复。
- 性能：录制与回放不明显影响系统响应。
- 安全：避免在日志中记录敏感输入。

## 8. 风险与对策
- 热键冲突：提示用户热键占用并拒绝保存。
- 回放误触发：托盘提示当前状态，支持立即停止。
- 权限限制：若钩子注册失败给出提示。

## 9. 验收标准
- 通过热键可启动/停止录制与回放。
- 回放次数与间隔按设置执行。
- 录制数据与设置持久化到本地目录。
- 托盘菜单功能齐全，设置可保存并立即生效。

## 10. 手动测试清单
- 设置不同热键并验证全局生效。
- 录制一段鼠标操作并回放 3 次，间隔 500ms。
- 回放中触发停止，确认立即终止。
- 删除本地数据目录后启动，验证自动重建并使用默认设置。
